<h1 id="partitioner">Partitioner</h1>
<p>The files in this folder provide scripts and executables to create the data partitions along with their logical ids that PageRank application reads as input. Note that PageRank application requires edge-cut partitions. The main executable is <code>graph_partitioner</code> that can be generated and used as follows:</p>
<pre><code>$ make
$ ./graph_partitioner
        -h [ --help ]         produce help message
        --nodefile arg        node file name
        --edgefile arg        edge file name
        --partitions arg      number of partitions
        --partitioner arg     partitioner : random, refine, coelesce, passes, 
                              fromfile
        --partition_file arg  partition_file
        --step1 arg           step1
        --step2 arg           step1
        --passes arg          number of times to refine partitions
        --outdir arg          output partitions and logical regions to this directory</code></pre>
<p>The default <code>reandom</code> partitioner does not generate good partitioning. So you could use METIS program to generate better partitions. The detail of METIS are provided in the following. It requires a specific input format that can be generated by applying <code>generate_metis_input.py</code> script, as follows:</p>
<pre><code>$ ./generate_metis_input.py  
        -h, --help            show this help message and exit
        -n NODEFILE, --nodefile=NODEFILE
                              input node file (node id)
        -e EDGEFILE, --edgefile=EDGEFILE
                              input edges file (src id, dst id)
        -o OUTFILE, --outfile=OUTFILE
                    output file (input to graph_partitioner)</code></pre>
<p>The output file is then fed into the <code>graph_partitioner</code> program to generate the partitions and logical id needed by the PageRank.</p>
<h2 id="example">Example</h2>
<p>Followings show a complete pipeline of generating the input partitions to PageRank from the <code>wikispeedia</code> node and edge files:</p>
<pre><code>$ ./generate_metis_input.py --nodefile ../../graph_samples/wikispeedia/articles.tsv
                            --edgefile ../../graph_samples/wikispeedia/links.tsv
                            --outfile &lt;metis-input&gt;

$ gpmetis &lt;metis-input&gt; &lt;partition-num&gt;

$ ./graph_partitioner --nodefile ../graph_samples/wikispeedia/articles.tsv
                      --edgefile ../graph_samples/wikispeedia/links.tsv
                      --partitions &lt;partition-num&gt;
                      --partitioner fromfile
                      --partition_file &lt;metis-input&gt;.part.&lt;partition-num&gt;
                      --outdir ../page_rank/input-sample-metis</code></pre>
<p>This is exactly how we generated the <code>input-sample-metis</code> in the <code>page_rank</code> directory that has 10 partitions. The <code>input-sample</code> in <code>page_rank</code> directory is a random partition in 10 pieces, generated without METIS by passing the <code>random</code> option to the <code>graph_partitioner</code></p>
<h1 id="metis">METIS</h1>
<p>For more information refer to: http://glaros.dtc.umn.edu/gkhome/metis/metis/download</p>
<h2 id="install">Install:</h2>
<p>Issue the following in the command line:</p>
<pre><code>$ sudo apt-get install metis</code></pre>
<h2 id="program">Program:</h2>
<p>To run the partitioner use the following command line:</p>
<pre><code>$ gpmetis [options] graphfile nparts</code></pre>
<p>It Partitions a graph into a specified number of parts (edge-cut). The computed partitioning is stored in a file named <code>graphfile.part.nparts</code>, where <code>graphfile</code> and <code>nparts</code> correspond to the specified parameters. <code>graphfile</code> is name of the file that stores the graph to be partitioned (see below for the input/output formats). <code>nparts</code> is the number of parts that the graph will be partitioned into. It should be greater than 1. For details of <code>options</code> refer to the METIS manual.</p>
<h2 id="input-format">Input Format:</h2>
<p>The primary input of the partitioning and fill-reducing ordering programs in METIS is the undirected graph to be partitioned or ordered. This graph is stored in a file and is supplied to the various programs as one of the command line parameters. A graph G = (V, E) with n vertices and m edges is stored in a plain text file that contains n + 1 lines (excluding comment lines). The first line, referred to as the header line contains information about the size and the type of the graph, while the remaining n lines contain information for each vertex of G. Any line that starts with ‘%’ is a comment line and is skipped. The header line contains either two (n, m), three (n, m, fmt), or four (n, m, fmt, ncon) parameters. The first two parameters (n, m) are the number of vertices and the number of edges, respectively. Note that in determining the number of edges m, an edge between any pair of vertices v and u is counted only once and not twice (i.e., we do not count the edge (v, u) separately from (u, v)). For now leave the fmt parameter as &quot;000&quot;. For more information refer to the METIS user manual.</p>
<h2 id="output-format">Output Format:</h2>
<p>The partition file of a graph with n vertices consists of n lines with a single number per line. The ith line of the file contains the partition number that the ith vertex belongs to. Partition numbers start from 0 up to the number of partitions minus one.</p>
<p>you can use the <code>generate_metis_input.py</code> script to generate the input format for METIS from node and edge files.</p>
